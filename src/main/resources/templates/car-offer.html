<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta
            name="viewport"
            content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
    />

    <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.2/css/all.css"
    />

    <meta http-equiv="X-UA-Compatible" content="ie=edge"/>

    <meta charset="UTF-8">
    <title>Home</title>

    <!--  This span is filled with <link> tags for css files!  -->
    <span>
        <!--  This span contains the css files for the navigation /desktop and mobile/  -->
        <span id="navigation-css"></span>
        <link rel="stylesheet" href="/css/styles/style.css">
        <link href="/css/styles/filters-styles.css" rel="stylesheet">
        <script src="https://kit.fontawesome.com/09640ec319.js" crossorigin="anonymous"></script>
        <link href="/css/styles/index-page-styles.css" rel="stylesheet">
        <link rel="stylesheet" href="/css/styles/offer-page-styles.css">
    </span>

    <!--  This span is filled with <script> tags for JavaScript files!  -->
    <span>
            <script src="/js/scripts/navigation-script.js" type="module"></script>
        <!--            <script src = "/js/scripts/index-page-script.js" type = "module"></script>-->
        </span>

</head>

<body>

<header th:fragment="navigation-header">
  <span id="mobile-user">
      <div style="background-color: #1a1d24; width: 100vw; height: 7.4rem"></div>
      <div class="hamburger">
          <i class="fas fa-bars"></i>
      </div>
      <nav class="nav">
          <ul class="nav-list">
              <li class="nav-item">
                  <a class="nav-link" href="#">
                      <span><i class="fas fa-home"></i></span> Home
                  </a>
              </li>
              <li class="nav-item">
                  <a class="nav-link current" href="#">
                      <span><i class="fas fa-register"></i></span> Register
                  </a>
              </li>
              <li class="nav-item">
                  <a class="nav-link" href="#">
                      <span><i class="fas fa-login"></i></span> Login
                  </a>
              </li>
              <li class="nav-item">
                  <a class="nav-link" href="#">
                      <span><i class="fas fa-logout"></i></span> Logout
                  </a>
              </li>
          </ul>
      </nav>
  </span>
    <span id="desktop-user">
        <nav class="navbar container">
            <a th:href="@{/}" class="nav-link">AutoDeluxe</a>
            <ul class="nav-list">
                <li class="nav-item">
                    <a th:href="@{/}" class="nav-link">Home</a>
                </li>

                <th:block th:if="${@loggedUser.isNotLoggedIn()}">
                    <li class="nav-item">
                        <a th:href="@{/auth/register}" class="nav-link">Register</a>
                    </li>
                    <li class="nav-item">
                        <a th:href="@{/auth/login}" class="nav-link">Login</a>
                    </li>
                </th:block>

                <th:block th:if="${@loggedUser.isLoggedIn()}">
                    <li class="nav-item">
                        <a class="nav-link" th:href="@{/car/add}">Add Car</a>
                    </li>
                </th:block>

                <th:block>
                    <li class="nav-item dropdown">
                        <a class="dropdown-header nav-link" th:text="${@loggedUser.username}"></a>
                        <th:block th:if="${@loggedUser.isLoggedIn()}">
                            <i class="fa-solid fa-caret-down dropdown-icon"></i>
                        </th:block>
                        <ul class="dropdown-menu">
                            <li class="dropdown-item">
                                <a href="#" class="nav-link"> Account</a>
                            </li>

                            <li class="dropdown-item">
                                <a href="#" class="nav-link">Settings</a>
                            </li>
                        </ul>
                    </li>
                </th:block>

                <th:block th:if="${@loggedUser.isLoggedIn()}">
                    <li class="nav-item">
                        <form th:action="@{/auth/logout}" th:method="POST" th:object="${@loggedUser}">
    <!--                        <a th:href="@{/auth/logout}" class = "nav-link" id = "logout-btn">Logout</a>-->
                            <input type="submit" value="Logout" class="nav-link"
                                   style="background: transparent; color: #fff; border: transparent; font-size: 1.6rem; cursor:pointer;">
                        </form>
                    </li>
                </th:block>
                <div class="active"></div>
            </ul>
        </nav>
    </span>
</header>

<span class="main-page">

</span>

<script th:type="module">
    const mainPage = document.querySelector('.main-page');
    const carId = window.location.pathname.split('/').pop(); // retrieve the car ID from the URL

    // Make a request to your REST API to retrieve the car with the specified ID
    fetch(`/api/cars/${carId}`)
        .then(response => response.json())
        .then(car => {
            const html = `
                <div class="main-container">
                    <img src="data:${car.imageType};base64,${car.image}" class="car-offer-image" alt="">
                    <div class = "offer-elements">
                        <div class = "header-container">
                            <h2 class = "offer-header">${car.make} ${car.model} ${car.series}</h2>
                        </div>

                        <div class = "condition-container"><h2 class = "condition">${car.condition}</h2></div>

                        <div class="description-div">
                            <p class="description">
                                ${car.description}
                            </p>
                        </div>
                        <div class = "seller-div"> <h5 class = "seller-info"> Seller: ${car.username}, ${car.email}</h5></div>
                        <form class = "buy-form">
                            <button type = "submit" class = "btn buy-car-btn">Buy Car</button>
                        </form>
                    </div>
                </div>
            `;
            mainPage.innerHTML = html;
            console.log(car)

        })
        .catch(error => console.error(error));
</script>


</body>
</html>